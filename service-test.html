<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PayEasy Services Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/react-router-dom@5.3.0/umd/react-router-dom.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/stellar-sdk/dist/stellar-sdk.js"></script>
  
  <!-- Load our services -->
  <script src="services/PolkadotService.js"></script>
  <script src="services/MidnightService.js"></script>
  <script src="services/AuthService.js"></script>
  <script src="services/ExchangeService.js"></script>
  <script src="services/ValidationService.js"></script>
  
  <!-- Debug script -->
  <script src="debug.js"></script>
</head>
<body class="bg-gray-100 p-8">
  <div class="max-w-3xl mx-auto bg-white p-6 rounded-lg shadow">
    <h1 class="text-2xl font-bold mb-4">PayEasy Services Test</h1>
    <p class="mb-4">This page tests if all services are loaded correctly.</p>
    
    <div id="services-info" class="mb-8">
      <h2 class="text-xl font-semibold mb-2">Service Status:</h2>
      <div class="space-y-2">
        <div id="polkadot-status" class="p-2 border rounded"></div>
        <div id="midnight-status" class="p-2 border rounded"></div>
        <div id="auth-status" class="p-2 border rounded"></div>
        <div id="exchange-status" class="p-2 border rounded"></div>
        <div id="validation-status" class="p-2 border rounded"></div>
      </div>
    </div>
    
    <div id="test-actions" class="mb-8">
      <h2 class="text-xl font-semibold mb-2">Test Actions:</h2>
      <div class="flex flex-wrap gap-2">
        <button id="test-polkadot" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">
          Test Polkadot
        </button>
        <button id="test-midnight" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded">
          Test Midnight
        </button>
        <button id="test-auth" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
          Test Auth
        </button>
        <button id="test-exchange" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded">
          Test Exchange
        </button>
        <button id="test-validation" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
          Test Validation
        </button>
      </div>
    </div>
    
    <div id="test-results" class="border p-4 bg-gray-50 rounded">
      <h2 class="text-xl font-semibold mb-2">Test Results:</h2>
      <pre id="results-area" class="whitespace-pre-wrap bg-black text-green-400 p-4 rounded h-48 overflow-auto"></pre>
    </div>
    
    <div id="diagnostics-output" class="mt-8"></div>
  </div>
  
  <script>
    // Helper function to check if a service is available
    function checkService(name, service) {
      const statusElem = document.getElementById(`${name}-status`);
      if (service) {
        statusElem.innerHTML = `<span class="text-green-600">✅</span> ${name} Service: <span class="font-medium">LOADED</span>`;
        statusElem.classList.add('bg-green-50');
        return true;
      } else {
        statusElem.innerHTML = `<span class="text-red-600">❌</span> ${name} Service: <span class="font-medium">NOT LOADED</span>`;
        statusElem.classList.add('bg-red-50');
        return false;
      }
    }
    
    // Helper to log test results
    function logResult(message) {
      const resultsArea = document.getElementById('results-area');
      const timestamp = new Date().toLocaleTimeString();
      resultsArea.textContent += `[${timestamp}] ${message}\n`;
      resultsArea.scrollTop = resultsArea.scrollHeight;
    }
    
    // Initialize when window loads
    window.addEventListener('load', function() {
      // Check all services
      checkService('polkadot', window.PolkadotService);
      checkService('midnight', window.MidnightService);
      checkService('auth', window.AuthService);
      checkService('exchange', window.ExchangeService);
      checkService('validation', window.ValidationService);
      
      // Add event listeners for test buttons
      document.getElementById('test-polkadot').addEventListener('click', async function() {
        try {
          logResult('Testing Polkadot Service...');
          if (!window.PolkadotService) {
            throw new Error('PolkadotService not available');
          }
          const result = await window.PolkadotService.connectWallet();
          logResult(`Connection result: ${JSON.stringify(result)}`);
        } catch (error) {
          logResult(`ERROR: ${error.message}`);
        }
      });
      
      document.getElementById('test-midnight').addEventListener('click', async function() {
        try {
          logResult('Testing Midnight Service...');
          if (!window.MidnightService) {
            throw new Error('MidnightService not available');
          }
          const result = await window.MidnightService.getChainInfo();
          logResult(`Chain info: ${JSON.stringify(result)}`);
        } catch (error) {
          logResult(`ERROR: ${error.message}`);
        }
      });
      
      document.getElementById('test-auth').addEventListener('click', function() {
        try {
          logResult('Testing Auth Service...');
          if (!window.AuthService) {
            throw new Error('AuthService not available');
          }
          const status = window.AuthService.checkLoginStatus();
          logResult(`Login status: ${JSON.stringify(status)}`);
        } catch (error) {
          logResult(`ERROR: ${error.message}`);
        }
      });
      
      document.getElementById('test-exchange').addEventListener('click', async function() {
        try {
          logResult('Testing Exchange Service...');
          if (!window.ExchangeService) {
            throw new Error('ExchangeService not available');
          }
          const rates = await window.ExchangeService.getCurrentRates();
          logResult(`Exchange rates: ${JSON.stringify(rates)}`);
        } catch (error) {
          logResult(`ERROR: ${error.message}`);
        }
      });
      
      document.getElementById('test-validation').addEventListener('click', function() {
        try {
          logResult('Testing Validation Service...');
          if (!window.ValidationService) {
            throw new Error('ValidationService not available');
          }
          const validAddress = 'GBVG2QOHHFBVHAEGNF4XRUCAPAGWDROONM2LC4BK4ECCQ5RTQOO64VBH';
          const result = window.ValidationService.validateStellarAddress(validAddress);
          logResult(`Address validation: ${JSON.stringify(result)}`);
        } catch (error) {
          logResult(`ERROR: ${error.message}`);
        }
      });
      
      logResult('Page loaded. All service checks complete.');
    });
  </script>
</body>
</html> 